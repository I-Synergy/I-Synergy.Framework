using System.Threading.Tasks;
using Microsoft.AspNetCore.Mvc;
using Mollie.Sample.Services.Payment.Refund;

namespace Mollie.Sample.Controllers {
    /// <summary>
    /// Class RefundController.
    /// Implements the <see cref="Controller" />
    /// </summary>
    /// <seealso cref="Controller" />
    /// <autogeneratedoc />
    public class RefundController : Controller {
        /// <summary>
        /// The refund payment client
        /// </summary>
        /// <autogeneratedoc />
        private readonly IRefundPaymentClient _refundPaymentClient;

        /// <summary>
        /// Initializes a new instance of the <see cref="RefundController"/> class.
        /// </summary>
        /// <param name="refundPaymentClient">The refund payment client.</param>
        /// <autogeneratedoc />
        public RefundController(IRefundPaymentClient refundPaymentClient) {
            _refundPaymentClient = refundPaymentClient;
        }

        /// <summary>
        /// Refunds the specified payment identifier.
        /// </summary>
        /// <param name="paymentId">The payment identifier.</param>
        /// <returns>IActionResult.</returns>
        /// <autogeneratedoc />
        [HttpPost]
        public async Task<IActionResult> Refund(string paymentId) {
            await _refundPaymentClient.Refund(paymentId);
            return RedirectToAction(nameof(PaymentController.Index), "Payment");
        }
    }
}
