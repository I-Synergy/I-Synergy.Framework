<c:View xmlns:c="using:ISynergy.Framework.UI.Controls"
    x:Class="ISynergy.Framework.UI.Sample.Views.Library.SelectionView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:i="using:Microsoft.Xaml.Interactivity"
    xmlns:ic="using:Microsoft.Xaml.Interactions.Core"
    xmlns:m="using:ISynergy.Framework.UI.Markup"
    xmlns:Converters="using:ISynergy.Framework.UI.Converters"
    xmlns:Behaviors="using:ISynergy.Framework.UI.Behaviors"
    xmlns:Extensions="using:ISynergy.Framework.UI.Extensions"
    mc:Ignorable="d"
    d:DesignHeight="300"
    d:DesignWidth="400">

    <c:View.Resources>
        <Converters:SelectionModeConverter x:Key="SelectionModeConverter" />
    </c:View.Resources>
    
    <Grid HorizontalAlignment="Center" Width="500">
        <RelativePanel Margin="10,5">
            <TextBlock x:Name="TextBlockTitle" 
                       RelativePanel.AlignTopWithPanel="True" 
                       RelativePanel.AlignLeftWithPanel="True" 
                       RelativePanel.AlignRightWithPanel="True" 
                       Text="{Binding Title}" 
                       Style="{StaticResource TitleTextBlockStyle}" />
            <RelativePanel x:Name="LayoutRoot"
                           RelativePanel.AlignLeftWithPanel="True"
                           RelativePanel.AlignRightWithPanel="True"
                           RelativePanel.AlignBottomWithPanel="True"
                           RelativePanel.Below="TextBlockTitle">
                <AutoSuggestBox x:Name="TopLayout"
                                PlaceholderText="{m:LanguageResource Key=Operation_Search}" 
                                RelativePanel.AlignLeftWithPanel="True" 
                                RelativePanel.AlignRightWithPanel="True" 
                                RelativePanel.AlignTopWithPanel="True"
                                Text="{Binding Query, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                QueryIcon="Find" 
                                IsTabStop="True">
                    <i:Interaction.Behaviors>
                        <ic:EventTriggerBehavior EventName="QuerySubmitted">
                            <ic:InvokeCommandAction Command="{Binding Search_Command}" CommandParameter="{Binding Text, ElementName=SearchQuery}" />
                        </ic:EventTriggerBehavior>
                    </i:Interaction.Behaviors>
                </AutoSuggestBox>

                <ListView RelativePanel.AlignLeftWithPanel="True" 
                          RelativePanel.AlignRightWithPanel="True" 
                          RelativePanel.Below="TopLayout" 
                          RelativePanel.Above="BottomLayout" 
                          x:Name="DataSummary" 
                          ItemsSource="{Binding Items}"
                          SelectionMode="{Binding SelectionMode, Converter={StaticResource SelectionModeConverter}}"
                          Extensions:ListViewExtensions.BindableSelection="{Binding SelectedItem, Mode=TwoWay}"
                          Margin="1,4" 
                          Style="{StaticResource ListViewMetroUI}">
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <TextBlock>
                                <Run Text="{Binding Description}"/>
                            </TextBlock>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>

                <StackPanel Orientation="Horizontal" x:Name="BottomLayout" RelativePanel.AlignRightWithPanel="True" RelativePanel.AlignBottomWithPanel="True">
                    <Button x:Name="Select_Button" Content="{m:LanguageResource Key=Operation_Select}" HorizontalAlignment="Right" Command="{Binding Submit_Command}" CommandParameter="{Binding SelectedItem}" />
                    <Button x:Name="Cancel_Button" Content="{m:LanguageResource Key=Cancel}" HorizontalAlignment="Right" Command="{Binding Close_Command}" />
                </StackPanel>
            </RelativePanel>
        </RelativePanel>
    </Grid>
</c:View>
